<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–°—Ç–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</title>
<style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: 'Arial', sans-serif; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; overflow:hidden; position:relative; color:#333; }
    .stars { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:0; }
    .star { position:absolute; width:2px; height:2px; background:white; border-radius:50%; animation:twinkle 3s infinite; }
    @keyframes twinkle { 0%,100%{opacity:0.3}50%{opacity:1} }
    .container { width:100%; height:100vh; position:relative; z-index:1; }
    .wish-card { position:absolute; background:rgba(255,255,255,0.95); padding:15px 20px; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.3); max-width:250px; word-wrap:break-word; animation:float 20s infinite linear; cursor:pointer; transition: transform 0.3s; backdrop-filter: blur(8px); font-size:14px; }
    .wish-card:hover { transform: scale(1.05) rotate(3deg); }
    .wish-card::before { content:'üéà'; position:absolute; top:-12px; right:-8px; font-size:26px; animation:bounce 2s infinite; }
    @keyframes bounce { 0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)} }
    .wish-text { font-size:14px; color:#333; line-height:1.4; margin-bottom:6px; }
    .wish-author { font-size:11px; color:#666; text-align:right; font-style:italic; }
    .input-container { position:fixed; bottom:0; left:0; right:0; background:rgba(255,255,255,0.15); backdrop-filter: blur(20px); padding:15px 25px; border-top:2px solid rgba(255,255,255,0.3); z-index:1000; }
    .input-wrapper { max-width:800px; margin:0 auto; display:flex; gap:12px; flex-wrap:wrap; }
    input, textarea { flex:1; min-width:180px; padding:12px; border:none; border-radius:15px; font-size:14px; background:rgba(255,255,255,0.9); color:#333; outline:none; transition: all 0.3s; }
    textarea { min-height:50px; resize:none; flex-basis:100%; }
    input:focus, textarea:focus { background:white; box-shadow:0 5px 15px rgba(0,0,0,0.2); }
    button { padding:12px 36px; background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%); color:white; border:none; border-radius:15px; font-size:14px; font-weight:bold; cursor:pointer; text-transform:uppercase; transition:all 0.3s; }
    button:hover { transform:translateY(-2px); box-shadow:0 8px 20px rgba(245,87,108,0.4); }
    button:active { transform:translateY(0); }
    .title { position:fixed; top:25px; left:50%; transform:translateX(-50%); color:white; font-size:36px; font-weight:bold; text-shadow:2px 2px 8px rgba(0,0,0,0.3); z-index:100; text-align:center; }
    @media(max-width:768px){.title{font-size:28px;top:15px}.input-wrapper{flex-direction:column}input,textarea{min-width:100%}}
</style>
</head>
<body>

<div class="stars" id="stars"></div>
<div class="title">üìù –°—Ç–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</div>
<div class="container" id="wishContainer"></div>

<div class="input-container">
    <div class="input-wrapper">
        <input type="text" id="nameInput" placeholder="–í–∞—à–µ –∏–º—è" maxlength="30">
        <textarea id="wishInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="200"></textarea>
        <button id="sendBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å üì®</button>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// Firebase –∫–æ–Ω—Ñ–∏–≥
const firebaseConfig = {
  apiKey: "AIzaSyC_iRQRECuIMxVbcZxSqAOfVaR4EasniSQ",
  authDomain: "well-67432.firebaseapp.com",
  projectId: "well-67432",
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// –ó–≤—ë–∑–¥—ã
const starsContainer = document.getElementById('stars');
for(let i=0;i<100;i++){
    const star=document.createElement('div');
    star.className='star';
    star.style.left=Math.random()*100+'%';
    star.style.top=Math.random()*100+'%';
    star.style.animationDelay=Math.random()*3+'s';
    starsContainer.appendChild(star);
}

// –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
const container=document.getElementById('wishContainer');
const emojis=['üéà','üéä','üéÅ','üéâ','üéÇ','üåü','‚ú®','üíù','üéÄ','üåà'];

// –ü–æ–ª—É—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Firebase –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∫ –∫–∞—Ä—Ç–æ—á–∫–∏
const q=query(collection(db,"messages"), orderBy("timestamp"));
onSnapshot(q, snapshot=>{
    container.innerHTML="";
    snapshot.forEach(doc=>{
        createWishCard({text:doc.data().text, author:doc.data().author||'–ê–Ω–æ–Ω–∏–º', id:doc.id});
    });
});

// –û—Ç–ø—Ä–∞–≤–∫–∞
const sendBtn=document.getElementById('sendBtn');
const wishInput=document.getElementById('wishInput');
const nameInput=document.getElementById('nameInput');

sendBtn.addEventListener('click', send);
wishInput.addEventListener('keydown', e=>{
    if(e.key==='Enter'&&!e.shiftKey){ e.preventDefault(); send(); }
});

async function send(){
    const text=wishInput.value.trim();
    if(!text) return;
    await addDoc(collection(db,"messages"),{
        text,
        author: nameInput.value.trim() || '–ê–Ω–æ–Ω–∏–º',
        timestamp: new Date()
    });
    wishInput.value='';
    nameInput.value='';
}

// –°–æ–∑–¥–∞—ë–º –∫–∞—Ä—Ç–æ—á–∫—É —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
function createWishCard(data){
    const card=document.createElement('div');
    card.className='wish-card';
    card.innerHTML=`<div class="wish-text">${data.text}</div><div class="wish-author">‚Äî ${data.author}</div>`;
    
    // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
    card.style.left=Math.random()*(window.innerWidth-250)+'px';
    card.style.top=Math.random()*(window.innerHeight-200)+'px';
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
    const duration=10+Math.random()*10;
    const startX=parseFloat(card.style.left);
    const startY=parseFloat(card.style.top);
    const endX=Math.random()*(window.innerWidth-250);
    const endY=Math.random()*(window.innerHeight-200);
    animateCard(card,startX,startY,endX,endY,duration);

    container.appendChild(card);
}

// –ê–Ω–∏–º–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
function animateCard(card,startX,startY,endX,endY,duration){
    let startTime=null;
    function animate(currentTime){
        if(!startTime) startTime=currentTime;
        const elapsed=currentTime-startTime;
        const progress=(elapsed/(duration*1000))%1;
        const currentX=startX+(endX-startX)*progress;
        const currentY=startY+(endY-startY)*progress + Math.sin(progress*Math.PI*4)*30;
        card.style.left=currentX+'px';
        card.style.top=currentY+'px';
        card.style.transform=`rotate(${Math.sin(progress*Math.PI*2)*10}deg)`;
        requestAnimationFrame(animate);
    }
    requestAnimationFrame(animate);
}
</script>
</body>
</html>
