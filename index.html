<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Стена сообщений</title>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  height: 100vh;
  font-family: system-ui, -apple-system, sans-serif;
  background: #0f0f0f;
  color: #eaeaea;
  display: flex;
  flex-direction: column;
}

/* ===== HEADER ===== */
.header {
  padding: 16px;
  text-align: center;
  border-bottom: 1px solid #262626;
  background: #121212;
}

.header h2 {
  font-size: 20px;
  font-weight: 500;
}

/* ===== WALL ===== */
.wall-container {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* scrollbar */
.wall-container::-webkit-scrollbar {
  width: 6px;
}
.wall-container::-webkit-scrollbar-thumb {
  background: #2a2a2a;
  border-radius: 10px;
}

/* ===== MESSAGE ===== */
.message {
  max-width: 75%;
  padding: 12px 14px;
  border-radius: 12px;
  background: #1a1a1a;
  border: 1px solid #262626;
  line-height: 1.4;
  animation: appear 0.25s ease;
}

.message:nth-child(odd) {
  align-self: flex-start;
}

.message:nth-child(even) {
  align-self: flex-end;
  background: #181818;
}

@keyframes appear {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ===== INPUT ===== */
.input-area {
  padding: 12px;
  display: flex;
  gap: 10px;
  border-top: 1px solid #262626;
  background: #121212;
}

#text {
  flex: 1;
  padding: 12px 14px;
  border-radius: 10px;
  border: 1px solid #2a2a2a;
  background: #0f0f0f;
  color: #eaeaea;
  font-size: 15px;
}

#text::placeholder {
  color: #666;
}

#text:focus {
  outline: none;
  border-color: #4caf50;
}

#sendBtn {
  padding: 0 22px;
  border-radius: 10px;
  border: none;
  background: #4caf50;
  color: #0f0f0f;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
}

#sendBtn:hover {
  background: #43a047;
}
</style>
</head>

<body>

<div class="header">
  <h2>Стена сообщений</h2>
</div>

<div class="wall-container" id="wall"></div>

<div class="input-area">
  <input
    id="text"
    type="text"
    placeholder="Напиши сообщение…"
    maxlength="500"
  >
  <button id="sendBtn">Отправить</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  addDoc,
  onSnapshot,
  query,
  orderBy
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyC_iRQRECuIMxVbcZxSqAOfVaR4EasniSQ",
  authDomain: "well-67432.firebaseapp.com",
  projectId: "well-67432",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const wall = document.getElementById("wall");
const input = document.getElementById("text");
const button = document.getElementById("sendBtn");

const q = query(
  collection(db, "messages"),
  orderBy("timestamp")
);

onSnapshot(q, snapshot => {
  wall.innerHTML = "";
  snapshot.forEach(doc => {
    const msg = document.createElement("div");
    msg.className = "message";
    msg.textContent = doc.data().text;
    wall.appendChild(msg);
  });
  wall.scrollTop = wall.scrollHeight;
});

button.addEventListener("click", send);
input.addEventListener("keydown", e => {
  if (e.key === "Enter") send();
});

async function send() {
  const text = input.value.trim();
  if (!text) return;

  await addDoc(collection(db, "messages"), {
    text,
    timestamp: new Date()
  });

  input.value = "";
}
</script>

</body>
</html>
